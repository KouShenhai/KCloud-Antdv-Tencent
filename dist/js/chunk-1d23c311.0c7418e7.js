(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d23c311"],{3962:function(t,e,i){"use strict";i.d(e,"e",(function(){return r})),i.d(e,"d",(function(){return o})),i.d(e,"a",(function(){return n})),i.d(e,"g",(function(){return s})),i.d(e,"b",(function(){return d})),i.d(e,"i",(function(){return u})),i.d(e,"h",(function(){return l})),i.d(e,"c",(function(){return c})),i.d(e,"f",(function(){return f}));var a=i("b775");function r(t){return Object(a["b"])({url:"/admin/sys/resource/video/api/query",method:"post",data:t})}function o(t){return Object(a["b"])({url:"/admin/sys/resource/video/api/detail?id="+t,method:"get"})}function n(t){return Object(a["b"])({url:"/admin/sys/resource/video/api/insert",method:"post",data:t})}function s(t){return Object(a["b"])({url:"/admin/sys/resource/video/api/update",method:"put",data:t})}function d(t){return Object(a["b"])({url:"/admin/sys/resource/video/api/delete?id="+t,method:"delete"})}function u(t){return Object(a["b"])({url:"/admin/sys/resource/video/api/upload",method:"post",data:t})}function l(t){return Object(a["b"])({url:"/admin/oss/api/upload",method:"post",data:t})}function c(t){return Object(a["b"])({url:"/admin/sys/resource/video/api/auditLog?resourceId="+t,method:"get"})}function f(){return Object(a["b"])({url:"/admin/sys/resource/video/api/sync?code=video",method:"post"})}},"7f8c":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-drawer",{attrs:{width:"35%","label-col":4,"wrapper-col":14,visible:t.open},on:{close:t.onClose}},[i("a-divider",{attrs:{orientation:"left"}},[i("b",[t._v(t._s(t.formTitle))])]),i("a-form-model",{ref:"form",attrs:{model:t.form,rules:t.rules}},[i("a-form-model-item",{attrs:{label:"标题",prop:"title"}},[i("a-input",{attrs:{placeholder:"请输入标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("a-form-model-item",{attrs:{label:"资源"}},[i("a-input",{staticStyle:{display:"none"},attrs:{placeholder:"请上传资源"},model:{value:t.form.uri,callback:function(e){t.$set(t.form,"uri",e)},expression:"form.uri"}}),i("a-upload",{attrs:{name:"file",accept:".mp4,.MP4,.AVI,.mov,.rmvb,.rm,.FLV,.mp4,.3GP,.flv","before-upload":t.beforeUpload},on:{change:t.uploadFile}},[i("a-button",{attrs:{disabled:t.disabled}},[t._v(" 上传视频 ")])],1),i("video",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"display"}],attrs:{src:t.form.uri,loop:"loop",width:"200",height:"100",controls:"controls"}},[i("source",{attrs:{src:t.form.uri,type:"video/mp4"}}),i("object",{attrs:{data:t.form.uri,width:"200",height:"100"}},[i("embed",{attrs:{src:t.form.uri,width:"200",height:"100"}})])])],1),i("a-form-model-item",{attrs:{label:"标签",prop:"tags"}},[t._l(t.tags,(function(e,a){return[i("a-tag",{key:e,attrs:{color:"#f50",closable:"",close:function(){return t.handleTagClose(e)}}},[t._v(t._s(e))])]})),t.tagInputVisible?i("a-input",{ref:"tagInput",style:{width:"78px"},attrs:{type:"text",size:"small",value:t.tagInputValue},on:{change:t.handleInputChange,blur:t.handleTagInputConfirm,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleTagInputConfirm.apply(null,arguments)}}}):i("a-tag",{staticStyle:{background:"#fff",borderStyle:"dashed"},on:{click:t.showTagInput}},[i("a-icon",{attrs:{type:"plus"}}),t._v("新增标签 ")],1)],2),i("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[i("a-input",{attrs:{placeholder:"请输入备注",type:"textarea","allow-clear":""},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),i("div",{staticClass:"bottom-control"},[i("a-space",[i("a-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submitForm}},[t._v(" 保存 ")]),i("a-button",{attrs:{type:"dashed"},on:{click:t.cancel}},[t._v(" 取消 ")])],1)],1)],1)],1)},r=[],o=i("2909"),n=(i("4de4"),i("d3b7"),i("caad"),i("2532"),i("99af"),i("ac1f"),i("1276"),i("a15b"),i("3962")),s={name:"CreateForm",components:{},data:function(){return{submitLoading:!1,formTitle:"",tagInputVisible:!1,tagInputValue:"",tags:[],form:{id:void 0,title:void 0,uri:void 0,md5:void 0,tags:void 0,code:"video",remark:void 0,processInstanceId:void 0},disabled:!1,open:!1,display:!1,rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],remark:[{required:!0,message:"备注不能为空",trigger:"blur"}]}}},filters:{},created:function(){},computed:{},watch:{},methods:{handleTagClose:function(t){var e=this.tags.filter((function(e){return e!==t}));this.tags=e},showTagInput:function(){var t=this;this.tagInputVisible=!0,this.$nextTick((function(){t.$refs.tagInput.focus()}))},handleInputChange:function(t){this.tagInputValue=t.target.value},handleTagInputConfirm:function(){var t=this.tagInputValue,e=this.tags;t&&!e.includes(t)&&(e=[].concat(Object(o["a"])(e),[t])),Object.assign(this,{tags:e,tagInputVisible:!1,tagInputValue:""})},onClose:function(){this.open=!1},cancel:function(){this.open=!1,this.reset()},reset:function(){this.tags=[],this.form={id:void 0,title:void 0,uri:void 0,md5:void 0,tags:void 0,code:"video",remark:void 0,processInstanceId:void 0}},uploadFile:function(t){var e=this;if(t.fileList.length>0){this.disabled=!0;var i=new FormData;i.append("file",t.file),Object(n["i"])(i).then((function(t){e.form.uri=t.data.url,e.form.md5=t.data.md5,null==e.form.uri?Object(n["h"])(i).then((function(t){e.form.uri=t.data.url,e.display=!0})):e.display=!0}))}else this.display=!1,this.disabled=!1,this.form.uri=void 0,this.form.md5=void 0},beforeUpload:function(){return!1},handleAdd:function(){this.reset(),this.form.id=void 0,this.open=!0,this.formTitle="视频新增"},handleUpdate:function(t,e){var i=this;this.reset();var a=t?t.id:e;Object(n["d"])(a).then((function(t){i.form.id=t.data.id,i.tags=t.data.tags.split(","),i.form.uri=t.data.uri,i.form.md5=t.data.md5,i.form.title=t.data.title,i.form.code="video",i.display=!0,i.form.processInstanceId=t.data.processInstanceId,i.form.remark=t.data.remark,i.open=!0,i.formTitle="视频修改"}))},submitForm:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.submitLoading=!0,t.form.tags=t.tags.join(","),void 0!==t.form.id?Object(n["g"])(t.form).then((function(e){t.$message.success("修改成功",3),t.open=!1,t.$emit("ok")})).finally((function(){t.submitLoading=!1})):Object(n["a"])(t.form).then((function(e){t.$message.success("新增成功",3),t.open=!1,t.$emit("ok")})).finally((function(){t.submitLoading=!1}))}))}}},d=s,u=i("2877"),l=Object(u["a"])(d,a,r,!1,null,null,null);e["default"]=l.exports}}]);