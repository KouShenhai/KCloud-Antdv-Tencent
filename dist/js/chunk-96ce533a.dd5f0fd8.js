(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-96ce533a"],{dd0b:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{width:"35%","label-col":4,"wrapper-col":14,visible:t.open},on:{close:t.onClose}},[a("a-divider",{attrs:{orientation:"left"}},[a("b",[t._v(t._s(t.formTitle))])]),a("a-form-model",{ref:"form",attrs:{model:t.form,rules:t.rules}},[a("a-form-model-item",{attrs:{label:"标题",prop:"title"}},[a("a-input",{attrs:{placeholder:"请输入标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("a-form-model-item",{attrs:{label:"资源"}},[a("a-input",{staticStyle:{display:"none"},attrs:{placeholder:"请上传资源"},model:{value:t.form.uri,callback:function(e){t.$set(t.form,"uri",e)},expression:"form.uri"}}),a("a-upload",{attrs:{name:"file",accept:".cda,.wav,.mp3,.aif,.aiff,.mid,.wma,.ra,.vqf,.ape,.CDA,.WAV,.MP3,.AIF,.AIFF,.MID,.WMA,.RA,.VQF,.APE","before-upload":t.beforeUpload},on:{change:t.uploadFile}},[a("a-button",{attrs:{disabled:t.disabled}},[t._v(" 上传音频 ")])],1),a("audio",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"display"}],attrs:{loop:"loop",src:t.form.uri,controls:"controls"}},[a("object",{attrs:{data:t.form.uri}},[a("embed",{attrs:{src:t.form.uri}})])])],1),a("a-form-model-item",{attrs:{label:"标签",prop:"tags"}},[t._l(t.tags,(function(e,i){return[a("a-tag",{key:e,attrs:{color:"#f50",closable:"",close:function(){return t.handleTagClose(e)}}},[t._v(t._s(e))])]})),t.tagInputVisible?a("a-input",{ref:"tagInput",style:{width:"78px"},attrs:{type:"text",size:"small",value:t.tagInputValue},on:{change:t.handleInputChange,blur:t.handleTagInputConfirm,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleTagInputConfirm.apply(null,arguments)}}}):a("a-tag",{staticStyle:{background:"#fff",borderStyle:"dashed"},on:{click:t.showTagInput}},[a("a-icon",{attrs:{type:"plus"}}),t._v("新增标签 ")],1)],2),a("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[a("a-input",{attrs:{placeholder:"请输入备注",type:"textarea","allow-clear":""},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),a("div",{staticClass:"bottom-control"},[a("a-space",[a("a-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submitForm}},[t._v(" 保存 ")]),a("a-button",{attrs:{type:"dashed"},on:{click:t.cancel}},[t._v(" 取消 ")])],1)],1)],1)],1)},o=[],r=a("2909"),n=(a("4de4"),a("d3b7"),a("caad"),a("2532"),a("99af"),a("ac1f"),a("1276"),a("a15b"),a("e166")),s={name:"CreateForm",components:{},data:function(){return{submitLoading:!1,formTitle:"",tagInputVisible:!1,tagInputValue:"",tags:[],form:{id:void 0,title:void 0,uri:void 0,md5:void 0,tags:void 0,code:"audio",remark:void 0,processInstanceId:void 0},disabled:!1,open:!1,display:!1,rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],remark:[{required:!0,message:"备注不能为空",trigger:"blur"}]}}},filters:{},created:function(){},computed:{},watch:{},methods:{handleTagClose:function(t){var e=this.tags.filter((function(e){return e!==t}));this.tags=e},showTagInput:function(){var t=this;this.tagInputVisible=!0,this.$nextTick((function(){t.$refs.tagInput.focus()}))},handleInputChange:function(t){this.tagInputValue=t.target.value},handleTagInputConfirm:function(){var t=this.tagInputValue,e=this.tags;t&&!e.includes(t)&&(e=[].concat(Object(r["a"])(e),[t])),Object.assign(this,{tags:e,tagInputVisible:!1,tagInputValue:""})},onClose:function(){this.open=!1},cancel:function(){this.open=!1,this.reset()},reset:function(){this.tags=[],this.form={id:void 0,title:void 0,uri:void 0,md5:void 0,tags:void 0,code:"audio",remark:void 0,processInstanceId:void 0}},uploadFile:function(t){var e=this;if(t.fileList.length>0){this.disabled=!0;var a=new FormData;a.append("file",t.file),Object(n["h"])(a).then((function(t){e.form.uri=t.data.url,e.form.md5=t.data.md5,null==e.form.uri?Object(n["i"])(a).then((function(t){e.form.uri=t.data.url,e.display=!0})):e.display=!0}))}else this.display=!1,this.disabled=!1,this.form.uri=void 0,this.form.md5=void 0},beforeUpload:function(){return!1},handleAdd:function(){this.reset(),this.form.id=void 0,this.open=!0,this.formTitle="音频新增"},handleUpdate:function(t,e){var a=this;this.reset();var i=t?t.id:e;Object(n["c"])(i).then((function(t){a.form.id=t.data.id,a.tags=t.data.tags.split(","),a.form.uri=t.data.uri,a.form.md5=t.data.md5,a.form.title=t.data.title,a.form.code="audio",a.display=!0,a.form.processInstanceId=t.data.processInstanceId,a.form.remark=t.data.remark,a.open=!0,a.formTitle="音频修改"}))},submitForm:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.submitLoading=!0,t.form.tags=t.tags.join(","),void 0!==t.form.id?Object(n["g"])(t.form).then((function(e){t.$message.success("修改成功",3),t.open=!1,t.$emit("ok")})).finally((function(){t.submitLoading=!1})):Object(n["a"])(t.form).then((function(e){t.$message.success("新增成功",3),t.open=!1,t.$emit("ok")})).finally((function(){t.submitLoading=!1}))}))}}},u=s,d=a("2877"),l=Object(d["a"])(u,i,o,!1,null,null,null);e["default"]=l.exports},e166:function(t,e,a){"use strict";a.d(e,"e",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return n})),a.d(e,"g",(function(){return s})),a.d(e,"b",(function(){return u})),a.d(e,"h",(function(){return d})),a.d(e,"i",(function(){return l})),a.d(e,"d",(function(){return c})),a.d(e,"f",(function(){return f}));var i=a("b775");function o(t){return Object(i["b"])({url:"/admin/sys/resource/audio/api/query",method:"post",data:t})}function r(t){return Object(i["b"])({url:"/admin/sys/resource/audio/api/detail?id="+t,method:"get"})}function n(t){return Object(i["b"])({url:"/admin/sys/resource/audio/api/insert",method:"post",data:t})}function s(t){return Object(i["b"])({url:"/admin/sys/resource/audio/api/update",method:"put",data:t})}function u(t){return Object(i["b"])({url:"/admin/sys/resource/audio/api/delete?id="+t,method:"delete"})}function d(t){return Object(i["b"])({url:"/admin/sys/resource/audio/api/upload",method:"post",data:t})}function l(t){return Object(i["b"])({url:"/admin/oss/api/upload",method:"post",data:t})}function c(t){return Object(i["b"])({url:"/admin/sys/resource/audio/api/auditLog?resourceId="+t,method:"get"})}function f(){return Object(i["b"])({url:"/admin/sys/resource/audio/api/sync?code=audio",method:"post"})}}}]);